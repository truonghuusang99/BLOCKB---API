const _0x551f=['collection','index','sort','FACE','toArray','139816BdNena','exports','FeatureCollection','coordinates','connect','map','mongo','length','insertedId','deleteRoom','toString','find','116132hVLKLI','deleteOne','deleteMany','insertOne','room','22731eLmDHt','199601DQXwXX','createRoom','1HcFnuk','110604ZfnWWM','3OrmeUh','1FniEYR','queryDataRoom','111521QcDQCG','geometry','1cUwqag','features','_id','mongodb','90796oQfBbe','push','BODY','Feature','NODE','block_b','../database/config','Polygon'];const _0x42e1=function(_0x44b4df,_0x41c1d4){_0x44b4df=_0x44b4df-0x96;let _0x551f08=_0x551f[_0x44b4df];return _0x551f08;};const _0xf7a14a=_0x42e1;(function(_0x2f27b4,_0xa502b){const _0x3c41a0=_0x42e1;while(!![]){try{const _0x5c0fe1=parseInt(_0x3c41a0(0xb4))+parseInt(_0x3c41a0(0xbe))+parseInt(_0x3c41a0(0xb6))*-parseInt(_0x3c41a0(0xb8))+-parseInt(_0x3c41a0(0x9f))*parseInt(_0x3c41a0(0xb3))+parseInt(_0x3c41a0(0xb0))+-parseInt(_0x3c41a0(0xba))*parseInt(_0x3c41a0(0xb1))+parseInt(_0x3c41a0(0xb5))*parseInt(_0x3c41a0(0xab));if(_0x5c0fe1===_0xa502b)break;else _0x2f27b4['push'](_0x2f27b4['shift']());}catch(_0x4dd24a){_0x2f27b4['push'](_0x2f27b4['shift']());}}}(_0x551f,0x1daf5));const {ObjectId}=require(_0xf7a14a(0xbd)),db=require(_0xf7a14a(0x98));module[_0xf7a14a(0xa0)][_0xf7a14a(0xb7)]=function(){return new Promise(async(_0x1a3529,_0x5369fb)=>{const _0x2c7056=_0x42e1;try{const _0x20e41d={'type':_0x2c7056(0xa1),'copyright':'Gi\x20Cung\x20Duoc\x20Group','timestamp':new Date(),'features':[]};await db[_0x2c7056(0xa5)]['connect']();const _0x5d2a02=await db[_0x2c7056(0xa5)]['db']('block_b'),_0x145cf9=await _0x5d2a02[_0x2c7056(0x9a)]('BODY')[_0x2c7056(0xaa)]({'graphic:type':{'$eq':_0x2c7056(0xaf)}})['toArray']();for(let _0x1e38d0=0x0;_0x1e38d0<_0x145cf9[_0x2c7056(0xa6)];_0x1e38d0++){_0x145cf9[_0x1e38d0][_0x2c7056(0xbc)]['toString']();let _0x42bcb4=await _0x5d2a02[_0x2c7056(0x9a)](_0x2c7056(0x9d))['find']({'id_body':_0x145cf9[_0x1e38d0][_0x2c7056(0xbc)][_0x2c7056(0xa9)]()})[_0x2c7056(0x9e)](),_0x72b22f={'type':_0x2c7056(0xc1),'properties':_0x145cf9[_0x1e38d0],'geometry':{'type':_0x42bcb4[_0x2c7056(0xa6)]>0x1?'MultiPolygon':_0x2c7056(0x99),'coordinates':[]}};for(let _0x3c5f58 of _0x42bcb4){let _0x205019=await(await _0x5d2a02[_0x2c7056(0x9a)](_0x2c7056(0x96))[_0x2c7056(0xaa)]({'id_face':_0x3c5f58[_0x2c7056(0xbc)]['toString']()})[_0x2c7056(0x9c)]([_0x2c7056(0x9b)],0x1)[_0x2c7056(0x9e)]())['map'](_0x5438e9=>{return[_0x5438e9['x'],_0x5438e9['y'],_0x5438e9['z']];});_0x72b22f[_0x2c7056(0xb9)][_0x2c7056(0xa2)][_0x2c7056(0xbf)](_0x205019);}_0x20e41d[_0x2c7056(0xbb)]['push'](_0x72b22f);}_0x1a3529(_0x20e41d);}catch(_0x41566a){_0x1a3529({'error':_0x41566a});throw _0x41566a;}});},module[_0xf7a14a(0xa0)][_0xf7a14a(0xb2)]=function(_0x45acf0,_0x30593f){return new Promise(async(_0x214ca6,_0x59ae36)=>{const _0x4b611c=_0x42e1;try{await db['mongo'][_0x4b611c(0xa3)]();const _0x33d13c=await db[_0x4b611c(0xa5)]['db'](_0x4b611c(0x97)),_0x3834c4=await _0x33d13c[_0x4b611c(0x9a)](_0x4b611c(0xc0))[_0x4b611c(0xae)](_0x45acf0);for(let _0x227e95 in _0x30593f){let _0x4b9a94=await _0x33d13c[_0x4b611c(0x9a)](_0x4b611c(0x9d))[_0x4b611c(0xae)]({'id_body':_0x3834c4[_0x4b611c(0xa7)]['toString']()}),_0x5099e4=_0x30593f[_0x227e95][_0x4b611c(0xa4)]((_0x32204c,_0x2fd157)=>{const _0x1fd3aa=_0x4b611c;return{'x':_0x32204c[0x0],'y':_0x32204c[0x1],'z':_0x32204c[0x2],'index':_0x2fd157,'id_face':_0x4b9a94[_0x1fd3aa(0xa7)][_0x1fd3aa(0xa9)]()};});await _0x33d13c[_0x4b611c(0x9a)](_0x4b611c(0x96))['insertMany'](_0x5099e4);}_0x214ca6({'id_body':_0x3834c4['insertedId']});}catch(_0x350c82){_0x214ca6(_0x350c82);}});},module[_0xf7a14a(0xa0)][_0xf7a14a(0xa8)]=function(_0x9b6b53){return new Promise(async(_0x2601ee,_0x1c9a90)=>{const _0x1c909d=_0x42e1;try{await db['mongo'][_0x1c909d(0xa3)]();const _0xc2d0cf=await db['mongo']['db'](_0x1c909d(0x97));await _0xc2d0cf[_0x1c909d(0x9a)](_0x1c909d(0xc0))[_0x1c909d(0xac)]({'_id':ObjectId(_0x9b6b53)});const _0x2a10e3=await _0xc2d0cf[_0x1c909d(0x9a)]('FACE')[_0x1c909d(0xaa)]({'id_body':_0x9b6b53[_0x1c909d(0xa9)]()})[_0x1c909d(0x9e)]();for(let _0x542e92 of _0x2a10e3){await _0xc2d0cf[_0x1c909d(0x9a)]('NODE')[_0x1c909d(0xad)]({'id_face':_0x542e92['_id'][_0x1c909d(0xa9)]()}),await _0xc2d0cf[_0x1c909d(0x9a)](_0x1c909d(0x9d))[_0x1c909d(0xac)]({'_id':_0x542e92[_0x1c909d(0xbc)]});}_0x2601ee('Success');}catch(_0x5154e2){_0x1c9a90(err);}});};