const _0x2450=['1361025YVBejq','FeatureCollection','block_b','insertOne','FACE','1LRNwxR','createStair','length','front-stair','toArray','43sdWqpA','insertedId','290459hzfEnx','connect','deleteMany','../database/config','1971XhPLPg','9YuhiwE','Gi\x20Cung\x20Duoc\x20Group','toString','deleteStair','deleteOne','features','sort','collection','coordinates','BODY','find','Feature','341prZioH','exports','Polygon','geometry','1ccYLLl','mongo','index','545651ESMkZr','14293pzhHRG','67001vNJITM','queryDataStair','NODE','_id','MultiPolygon','insertMany','318332kPmzcC','map','push'];const _0x9b80=function(_0x20782d,_0x55367d){_0x20782d=_0x20782d-0x13d;let _0x2450c7=_0x2450[_0x20782d];return _0x2450c7;};const _0x3f742d=_0x9b80;(function(_0x485b6f,_0x4f0224){const _0x34513b=_0x9b80;while(!![]){try{const _0x3aaa6f=-parseInt(_0x34513b(0x156))*parseInt(_0x34513b(0x16b))+-parseInt(_0x34513b(0x147))+-parseInt(_0x34513b(0x154))*parseInt(_0x34513b(0x140))+parseInt(_0x34513b(0x14a))+parseInt(_0x34513b(0x167))*parseInt(_0x34513b(0x15a))+parseInt(_0x34513b(0x141))*-parseInt(_0x34513b(0x15b))+-parseInt(_0x34513b(0x14f))*-parseInt(_0x34513b(0x13f));if(_0x3aaa6f===_0x4f0224)break;else _0x485b6f['push'](_0x485b6f['shift']());}catch(_0x124eff){_0x485b6f['push'](_0x485b6f['shift']());}}}(_0x2450,0xb7b04));const db=require(_0x3f742d(0x159));module[_0x3f742d(0x168)][_0x3f742d(0x142)]=function(){return new Promise(async(_0x1b2e1a,_0x417a1c)=>{const _0x4340f5=_0x9b80;try{const _0x59ddb0={'type':_0x4340f5(0x14b),'copyright':_0x4340f5(0x15c),'timestamp':new Date(),'features':[]};await db['mongo'][_0x4340f5(0x157)]();const _0x517a78=await db['mongo']['db'](_0x4340f5(0x14c)),_0x2641de=await _0x517a78[_0x4340f5(0x162)]('BODY')[_0x4340f5(0x165)]({'graphic:type':{'$eq':'stair'}})['toArray']();for(let _0x288373=0x0;_0x288373<_0x2641de[_0x4340f5(0x151)];_0x288373++){_0x2641de[_0x288373][_0x4340f5(0x144)][_0x4340f5(0x15d)]();let _0x310147=await _0x517a78[_0x4340f5(0x162)]('FACE')['find']({'id_body':_0x2641de[_0x288373][_0x4340f5(0x144)][_0x4340f5(0x15d)]()})[_0x4340f5(0x153)](),_0x8ef664={'type':_0x4340f5(0x166),'properties':_0x2641de[_0x288373],'geometry':{'type':_0x310147[_0x4340f5(0x151)]>0x1?_0x4340f5(0x145):'Polygon','coordinates':[]}};for(let _0x42c0c8 of _0x310147){let _0x4abc6a=await(await _0x517a78['collection']('NODE')[_0x4340f5(0x165)]({'id_face':_0x42c0c8[_0x4340f5(0x144)][_0x4340f5(0x15d)]()})[_0x4340f5(0x161)]([_0x4340f5(0x13e)],0x1)[_0x4340f5(0x153)]())[_0x4340f5(0x148)](_0x36e1fd=>{return[_0x36e1fd['x'],_0x36e1fd['y'],_0x36e1fd['z']];});_0x8ef664[_0x4340f5(0x16a)][_0x4340f5(0x163)][_0x4340f5(0x149)](_0x4abc6a);}_0x59ddb0[_0x4340f5(0x160)][_0x4340f5(0x149)](_0x8ef664);}_0x1b2e1a(_0x59ddb0);}catch(_0x3df0f0){_0x1b2e1a({'error':_0x3df0f0});throw _0x3df0f0;}});},module[_0x3f742d(0x168)]['queryDataFrontStair']=function(_0xd09958){return new Promise(async _0x3fad5c=>{const _0x2a2b6a=_0x9b80;try{const _0x31740d={'type':'FeatureCollection','copyright':_0x2a2b6a(0x15c),'timestamp':new Date(),'features':[]};await db[_0x2a2b6a(0x13d)]['connect']();const _0x2e5d2d=await db[_0x2a2b6a(0x13d)]['db'](_0x2a2b6a(0x14c)),_0xa8b353=await _0x2e5d2d[_0x2a2b6a(0x162)](_0x2a2b6a(0x164))[_0x2a2b6a(0x165)]({'graphic:type':{'$eq':_0x2a2b6a(0x152)},'graphic:height':{'$eq':_0xd09958}})[_0x2a2b6a(0x153)]();for(let _0x9801a5=0x0;_0x9801a5<_0xa8b353[_0x2a2b6a(0x151)];_0x9801a5++){_0xa8b353[_0x9801a5][_0x2a2b6a(0x144)][_0x2a2b6a(0x15d)]();let _0x2440e8=await _0x2e5d2d[_0x2a2b6a(0x162)]('FACE')[_0x2a2b6a(0x165)]({'id_body':_0xa8b353[_0x9801a5][_0x2a2b6a(0x144)][_0x2a2b6a(0x15d)]()})[_0x2a2b6a(0x153)](),_0x37d49c={'type':_0x2a2b6a(0x166),'properties':_0xa8b353[_0x9801a5],'geometry':{'type':_0x2440e8[_0x2a2b6a(0x151)]>0x1?'MultiPolygon':_0x2a2b6a(0x169),'coordinates':[]}};for(let _0x21298a of _0x2440e8){let _0x485246=await(await _0x2e5d2d[_0x2a2b6a(0x162)](_0x2a2b6a(0x143))[_0x2a2b6a(0x165)]({'id_face':_0x21298a[_0x2a2b6a(0x144)][_0x2a2b6a(0x15d)]()})['sort']([_0x2a2b6a(0x13e)],0x1)[_0x2a2b6a(0x153)]())['map'](_0x59ce12=>{return[_0x59ce12['x'],_0x59ce12['y'],_0x59ce12['z']];});_0x37d49c['geometry'][_0x2a2b6a(0x163)]['push'](_0x485246);}_0x31740d[_0x2a2b6a(0x160)][_0x2a2b6a(0x149)](_0x37d49c);}_0x3fad5c(_0x31740d);}catch(_0x1a44de){_0x3fad5c({'error':_0x1a44de});throw _0x1a44de;}});},module[_0x3f742d(0x168)][_0x3f742d(0x150)]=function(_0x2d5a71,_0x5295f6){return new Promise(async(_0x5b6542,_0x203c7a)=>{const _0x45147a=_0x9b80;try{await db['mongo'][_0x45147a(0x157)]();const _0x8732b3=await db[_0x45147a(0x13d)]['db'](_0x45147a(0x14c)),_0x43cb32=await _0x8732b3['collection'](_0x45147a(0x164))[_0x45147a(0x14d)](_0x2d5a71);for(let _0x21d613 in _0x5295f6){let _0x5f0231=await _0x8732b3[_0x45147a(0x162)](_0x45147a(0x14e))[_0x45147a(0x14d)]({'id_body':_0x43cb32['insertedId'][_0x45147a(0x15d)]()}),_0x2db3cc=_0x5295f6[_0x21d613]['map']((_0x384508,_0x2ae7cb)=>{const _0x5e4f9c=_0x45147a;return{'x':_0x384508[0x0],'y':_0x384508[0x1],'z':_0x384508[0x2],'index':_0x2ae7cb,'id_face':_0x5f0231['insertedId'][_0x5e4f9c(0x15d)]()};});await _0x8732b3[_0x45147a(0x162)](_0x45147a(0x143))[_0x45147a(0x146)](_0x2db3cc);}_0x5b6542({'id_body':_0x43cb32[_0x45147a(0x155)]});}catch(_0x7969d8){_0x5b6542(_0x7969d8);}});},module[_0x3f742d(0x168)][_0x3f742d(0x15e)]=function(_0x14240d){return new Promise(async(_0x2289ba,_0x65da8d)=>{const _0x207fda=_0x9b80;try{await db['mongo']['connect']();const _0x530e3f=await db[_0x207fda(0x13d)]['db'](_0x207fda(0x14c));await _0x530e3f[_0x207fda(0x162)](_0x207fda(0x164))[_0x207fda(0x15f)]({'_id':ObjectId(_0x14240d)});const _0xdd4678=await _0x530e3f[_0x207fda(0x162)](_0x207fda(0x14e))['find']({'id_body':_0x14240d[_0x207fda(0x15d)]()})[_0x207fda(0x153)]();for(let _0x1b53dc of _0xdd4678){await _0x530e3f['collection']('NODE')[_0x207fda(0x158)]({'id_face':_0x1b53dc[_0x207fda(0x144)][_0x207fda(0x15d)]()}),await _0x530e3f[_0x207fda(0x162)](_0x207fda(0x14e))[_0x207fda(0x15f)]({'_id':_0x1b53dc[_0x207fda(0x144)]});}_0x2289ba('Success');}catch(_0x14e56c){_0x65da8d(err);}});};