const _0x49f7=['39304oGtFKS','overpass-ide','SURFACE','MultiLineString','toString','queryDataWindow','insertOne','399wEuBkL','1021244BlgTbI','createWindow','window-line','97695eYdXip','collection','mongo','deleteMany','989cjhJHz','queryDataWindowStairLine','block_b','coordinates','FACE','sort','features','deleteWindow','1PucJLK','deleteOne','NODE','52mPjKIR','map','length','Feature','delete','Gi\x20Cung\x20Duoc\x20Group','queryDataWindowLine','exports','10HgSXHW','_id','find','toArray','index','geometry','Success','376332NJqlzy','14428BdXlbc','FeatureCollection','connect','insertedId','2906ninzBb','push'];const _0x3359=function(_0x26e045,_0x410cef){_0x26e045=_0x26e045-0x76;let _0x49f757=_0x49f7[_0x26e045];return _0x49f757;};const _0x6d7c36=_0x3359;(function(_0x212649,_0x223425){const _0x5b14e1=_0x3359;while(!![]){try{const _0x59ea0e=parseInt(_0x5b14e1(0x88))*-parseInt(_0x5b14e1(0x80))+-parseInt(_0x5b14e1(0x93))*-parseInt(_0x5b14e1(0x77))+parseInt(_0x5b14e1(0x79))+parseInt(_0x5b14e1(0x84))*parseInt(_0x5b14e1(0x90))+-parseInt(_0x5b14e1(0xa2))+parseInt(_0x5b14e1(0x9b))*-parseInt(_0x5b14e1(0xa3))+parseInt(_0x5b14e1(0x81));if(_0x59ea0e===_0x223425)break;else _0x212649['push'](_0x212649['shift']());}catch(_0x571809){_0x212649['push'](_0x212649['shift']());}}}(_0x49f7,0x60394));const db=require('../database/config');module[_0x6d7c36(0x9a)][_0x6d7c36(0x7e)]=function(_0x4ee7b5,_0x196752=null){return new Promise(async(_0x22efd9,_0x28f729)=>{const _0x484f82=_0x3359;try{const _0xf34e53={'type':_0x484f82(0xa4),'copyright':_0x484f82(0x98),'timestamp':new Date(),'features':[]};await db[_0x484f82(0x86)][_0x484f82(0xa5)]();const _0x44569e=await db['mongo']['db'](_0x484f82(0x8a)),_0x493821=await _0x44569e[_0x484f82(0x85)](_0x484f82(0x7b))[_0x484f82(0x9d)]({'graphic:type':{'$eq':_0x4ee7b5},'graphic:height':{'$eq':_0x196752}})[_0x484f82(0x9e)]();for(let _0x192172=0x0;_0x192172<_0x493821[_0x484f82(0x95)];_0x192172++){_0x493821[_0x192172][_0x484f82(0x9c)][_0x484f82(0x7d)]();let _0x5a036e=await _0x44569e[_0x484f82(0x85)](_0x484f82(0x8c))[_0x484f82(0x9d)]({'id_surface':_0x493821[_0x192172][_0x484f82(0x9c)][_0x484f82(0x7d)]()})[_0x484f82(0x9e)](),_0x364e23={'type':_0x484f82(0x96),'properties':_0x493821[_0x192172],'geometry':{'type':_0x484f82(0x7c),'coordinates':[]}};for(let _0x4aba2a of _0x5a036e){let _0x38e52c=await(await _0x44569e['collection']('NODE')[_0x484f82(0x9d)]({'id_face':_0x4aba2a[_0x484f82(0x9c)][_0x484f82(0x7d)]()})[_0x484f82(0x8d)]([_0x484f82(0x9f)],0x1)['toArray']())[_0x484f82(0x94)](_0x420168=>{return[_0x420168['x'],_0x420168['y'],_0x420168['z']];});_0x364e23[_0x484f82(0xa0)][_0x484f82(0x8b)][_0x484f82(0x78)](_0x38e52c);}_0xf34e53[_0x484f82(0x8e)][_0x484f82(0x78)](_0x364e23);}_0x22efd9(_0xf34e53);}catch(_0x5ee39c){_0x22efd9({'error':_0x5ee39c});throw _0x5ee39c;}});},module[_0x6d7c36(0x9a)][_0x6d7c36(0x99)]=function(_0x27d902,_0x3aef00=null){return new Promise(async(_0x1297ef,_0x34b481)=>{const _0x3f01c6=_0x3359;try{const _0x2f8c61={'type':_0x3f01c6(0xa4),'generator':_0x3f01c6(0x7a),'copyright':_0x3f01c6(0x98),'timestamp':new Date(),'features':[]};await db[_0x3f01c6(0x86)][_0x3f01c6(0xa5)]();const _0x424e9=await db[_0x3f01c6(0x86)]['db'](_0x3f01c6(0x8a)),_0x14af43=await _0x424e9[_0x3f01c6(0x85)](_0x3f01c6(0x7b))['find'](_0x3aef00!=null?{'graphic:type':{'$eq':_0x27d902},'graphic:height':{'$eq':_0x3aef00}}:{'graphic:type':{'$eq':_0x27d902}})['toArray']();for(let _0x567e80=0x0;_0x567e80<_0x14af43['length'];_0x567e80++){let _0x3a8241=await _0x424e9['collection']('FACE')[_0x3f01c6(0x9d)]({'id_surface':_0x14af43[_0x567e80]['_id']['toString']()})['toArray'](),_0x2ee132={'type':'Feature','properties':_0x14af43[_0x567e80],'geometry':{'type':_0x3f01c6(0x7c),'coordinates':[]}};for(let _0x4078a1=0x0;_0x4078a1<_0x3a8241[_0x3f01c6(0x95)];_0x4078a1++){let _0xf2dad2=await(await _0x424e9[_0x3f01c6(0x85)](_0x3f01c6(0x92))['find']({'id_face':_0x3a8241[_0x4078a1]['_id']['toString']()})[_0x3f01c6(0x8d)]([_0x3f01c6(0x9f)],0x1)[_0x3f01c6(0x9e)]())[_0x3f01c6(0x94)](_0x12c923=>_0x12c923[_0x3f01c6(0xa0)]);_0x2ee132[_0x3f01c6(0xa0)][_0x3f01c6(0x8b)]=_0xf2dad2;}_0x2f8c61[_0x3f01c6(0x8e)][_0x3f01c6(0x78)](_0x2ee132);}_0x1297ef(_0x2f8c61);}catch(_0x3f764c){_0x1297ef({'error':_0x3f764c});throw _0x3f764c;}});},module['exports'][_0x6d7c36(0x89)]=function(){return new Promise(async(_0x15698d,_0x154f48)=>{const _0x9b039=_0x3359;try{const _0x15428b={'type':'FeatureCollection','generator':_0x9b039(0x7a),'copyright':_0x9b039(0x98),'timestamp':new Date(),'features':[]};await db[_0x9b039(0x86)]['connect']();const _0x27531b=await db[_0x9b039(0x86)]['db']('block_b'),_0x590b89=await _0x27531b[_0x9b039(0x85)](_0x9b039(0x7b))[_0x9b039(0x9d)]({'graphic:type':{'$eq':'window-stair-line'}})[_0x9b039(0x9e)]();for(let _0x20a0a4=0x0;_0x20a0a4<_0x590b89['length'];_0x20a0a4++){let _0x445ee9=await _0x27531b['collection'](_0x9b039(0x8c))['find']({'id_surface':_0x590b89[_0x20a0a4][_0x9b039(0x9c)][_0x9b039(0x7d)]()})[_0x9b039(0x9e)](),_0x1790fa={'type':_0x9b039(0x96),'properties':_0x590b89[_0x20a0a4],'geometry':{'type':_0x9b039(0x7c),'coordinates':[]}};for(let _0xd456b9=0x0;_0xd456b9<_0x445ee9['length'];_0xd456b9++){let _0x4d82ad=await(await _0x27531b[_0x9b039(0x85)](_0x9b039(0x92))[_0x9b039(0x9d)]({'id_face':_0x445ee9[_0xd456b9]['_id'][_0x9b039(0x7d)]()})['sort']([_0x9b039(0x9f)],0x1)['toArray']())[_0x9b039(0x94)](_0x86c315=>_0x86c315[_0x9b039(0xa0)]);_0x1790fa[_0x9b039(0xa0)][_0x9b039(0x8b)]['push'](_0x4d82ad);}_0x15428b[_0x9b039(0x8e)][_0x9b039(0x78)](_0x1790fa);}_0x15698d(_0x15428b);}catch(_0xb22f82){_0x15698d({'error':_0xb22f82});throw _0xb22f82;}});},module[_0x6d7c36(0x9a)][_0x6d7c36(0x82)]=function(_0xaaf658,_0x331500){return new Promise(async(_0x404335,_0x2c3a2c)=>{const _0x4bd5e5=_0x3359;try{await db[_0x4bd5e5(0x86)]['connect']();const _0x4f145d=await db[_0x4bd5e5(0x86)]['db'](_0x4bd5e5(0x8a)),_0x36888a=await _0x4f145d[_0x4bd5e5(0x85)](_0x4bd5e5(0x7b))['insertOne'](_0xaaf658);for(let _0x3c1e4c in _0x331500){let _0x900703=await _0x4f145d['collection'](_0x4bd5e5(0x8c))[_0x4bd5e5(0x7f)]({'id_surface':_0x36888a[_0x4bd5e5(0x76)][_0x4bd5e5(0x7d)]()}),_0x486acd=_0x331500[_0x3c1e4c]['map']((_0x50da9b,_0x238dee)=>{return{'x':_0x50da9b[0x0],'y':_0x50da9b[0x1],'z':_0x50da9b[0x2],'index':_0x238dee,'id_face':_0x900703['insertedId']['toString']()};});await _0x4f145d[_0x4bd5e5(0x85)](_0x4bd5e5(0x92))['insertMany'](_0x486acd);}_0x404335({'id_surface':_0x36888a[_0x4bd5e5(0x76)]});}catch(_0x60f5c3){_0x404335(_0x60f5c3);}});},module[_0x6d7c36(0x9a)][_0x6d7c36(0x8f)]=function(_0xa9c688){return new Promise(async(_0x501cb9,_0x4125ae)=>{const _0x21534d=_0x3359;try{await db[_0x21534d(0x86)][_0x21534d(0xa5)]();const _0x4ea568=await db[_0x21534d(0x86)]['db'](_0x21534d(0x8a));await _0x4ea568[_0x21534d(0x85)](_0x21534d(0x7b))[_0x21534d(0x91)]({'_id':_0xa9c688});const _0x77e0=await _0x4ea568['collection'](_0x21534d(0x8c))[_0x21534d(0x9d)]({'id_surface':_0xa9c688[_0x21534d(0x7d)]()})[_0x21534d(0x9e)]();for(let _0x267777 of _0x77e0){await _0x4ea568[_0x21534d(0x85)]('NODE')[_0x21534d(0x87)]({'id_face':_0x267777[_0x21534d(0x9c)]['toString']()}),await _0x4ea568['collection']('FACE')[_0x21534d(0x91)]({'_id':_0x267777['_id']});}_0x501cb9('Success');}catch(_0x86cbc5){_0x501cb9(_0x86cbc5);}});},module[_0x6d7c36(0x9a)][_0x6d7c36(0x97)]=function(){return new Promise(async(_0x25b28f,_0x8cbc35)=>{const _0x10e4a3=_0x3359;try{await db[_0x10e4a3(0x86)]['connect']();const _0x52d75e=await db[_0x10e4a3(0x86)]['db']('block_b'),_0x2a7a2b=await _0x52d75e[_0x10e4a3(0x85)](_0x10e4a3(0x7b))[_0x10e4a3(0x9d)]({'graphic:type':_0x10e4a3(0x83)})[_0x10e4a3(0x9e)]();for(let _0x211aa3 of _0x2a7a2b){await _0x52d75e['collection'](_0x10e4a3(0x7b))[_0x10e4a3(0x91)]({'_id':_0x211aa3[_0x10e4a3(0x9c)]});const _0x203402=await _0x52d75e[_0x10e4a3(0x85)]('FACE')['find']({'id_surface':_0x211aa3['_id'][_0x10e4a3(0x7d)]()})['toArray']();for(let _0x1a88bb of _0x203402){await _0x52d75e[_0x10e4a3(0x85)](_0x10e4a3(0x92))[_0x10e4a3(0x87)]({'id_face':_0x1a88bb[_0x10e4a3(0x9c)][_0x10e4a3(0x7d)]()}),await _0x52d75e[_0x10e4a3(0x85)](_0x10e4a3(0x8c))['deleteOne']({'_id':_0x1a88bb[_0x10e4a3(0x9c)]});}}_0x25b28f(_0x10e4a3(0xa1));}catch(_0x1144d6){_0x25b28f(_0x1144d6);}});};