const _0x1a96=['coordinates','136685GIRqHI','66274LZwiKd','queryDataWallLine','440222XoxdIi','FACE','SURFACE','features','createWall','12AyhgUy','FeatureCollection','635788vfEvnv','wall','Feature','insertOne','connect','Success','collection','deleteWall','block_b','map','_id','exports','Gi\x20Cung\x20Duoc\x20Group','deleteMany','mongo','insertedId','toString','LineString','sort','length','17fQwmFd','queryDataWall','35851BgOHnv','toArray','index','push','find','859616hWfsrb','647372smYvXO','6WuqLFi','geometry','NODE'];const _0x50cb=function(_0x11ca67,_0x814cec){_0x11ca67=_0x11ca67-0x18a;let _0x1a960e=_0x1a96[_0x11ca67];return _0x1a960e;};const _0xcf247e=_0x50cb;(function(_0x5f235f,_0x30ccce){const _0x3b22a3=_0x50cb;while(!![]){try{const _0x5c05b1=parseInt(_0x3b22a3(0x1ae))*-parseInt(_0x3b22a3(0x1b0))+parseInt(_0x3b22a3(0x19a))+-parseInt(_0x3b22a3(0x198))*-parseInt(_0x3b22a3(0x191))+-parseInt(_0x3b22a3(0x18c))*-parseInt(_0x3b22a3(0x190))+parseInt(_0x3b22a3(0x193))+-parseInt(_0x3b22a3(0x18b))+-parseInt(_0x3b22a3(0x18a));if(_0x5c05b1===_0x30ccce)break;else _0x5f235f['push'](_0x5f235f['shift']());}catch(_0x3106c3){_0x5f235f['push'](_0x5f235f['shift']());}}}(_0x1a96,0x8c5e9));const db=require('../database/config');module[_0xcf247e(0x1a5)][_0xcf247e(0x192)]=function(_0xc16e27){return new Promise(async(_0x317a1f,_0x38ad30)=>{const _0x244674=_0x50cb;try{const _0x83ca33={'type':_0x244674(0x199),'copyright':_0x244674(0x1a6),'timestamp':new Date(),'features':[]};await db[_0x244674(0x1a8)][_0x244674(0x19e)]();const _0x4063ec=await db[_0x244674(0x1a8)]['db'](_0x244674(0x1a2)),_0x191e80=await _0x4063ec['collection'](_0x244674(0x195))['find']({'graphic:type':{'$eq':'wall-line'},'graphic:height':{'$eq':_0xc16e27}})[_0x244674(0x1b1)]();for(let _0x4949ad=0x0;_0x4949ad<_0x191e80[_0x244674(0x1ad)];_0x4949ad++){_0x191e80[_0x4949ad]['_id'][_0x244674(0x1aa)]();let _0x52fa7f=await _0x4063ec[_0x244674(0x1a0)](_0x244674(0x194))[_0x244674(0x1b4)]({'id_surface':_0x191e80[_0x4949ad][_0x244674(0x1a4)]['toString']()})[_0x244674(0x1b1)](),_0x426c15={'type':'Feature','properties':_0x191e80[_0x4949ad],'geometry':{'type':_0x52fa7f[_0x244674(0x1ad)]>0x1?'MultiLineString':'LineString','coordinates':[]}};for(let _0x2bca11 of _0x52fa7f){let _0x58befa=await(await _0x4063ec['collection'](_0x244674(0x18e))['find']({'id_face':_0x2bca11[_0x244674(0x1a4)]['toString']()})[_0x244674(0x1ac)](['index'],0x1)[_0x244674(0x1b1)]())[_0x244674(0x1a3)](_0x32b0af=>{return[_0x32b0af['x'],_0x32b0af['y'],_0x32b0af['z']];});_0x426c15[_0x244674(0x18d)][_0x244674(0x18f)][_0x244674(0x1b3)](_0x58befa);}_0x83ca33['features']['push'](_0x426c15);}_0x317a1f(_0x83ca33);}catch(_0x22f299){_0x317a1f({'error':_0x22f299});throw _0x22f299;}});},module[_0xcf247e(0x1a5)][_0xcf247e(0x1af)]=function(){return new Promise(async(_0x1077a8,_0x499790)=>{const _0x33cc7a=_0x50cb;try{const _0x32c86a={'type':_0x33cc7a(0x199),'copyright':_0x33cc7a(0x1a6),'timestamp':new Date(),'features':[]};await db['mongo'][_0x33cc7a(0x19e)]();const _0x14b3dd=await db[_0x33cc7a(0x1a8)]['db'](_0x33cc7a(0x1a2)),_0x59fc48=await _0x14b3dd[_0x33cc7a(0x1a0)](_0x33cc7a(0x195))[_0x33cc7a(0x1b4)]({'graphic:type':{'$eq':_0x33cc7a(0x19b)}})['toArray']();for(let _0x10ec5e=0x0;_0x10ec5e<_0x59fc48[_0x33cc7a(0x1ad)];_0x10ec5e++){_0x59fc48[_0x10ec5e][_0x33cc7a(0x1a4)]['toString']();let _0x12def4=await _0x14b3dd[_0x33cc7a(0x1a0)]('FACE')[_0x33cc7a(0x1b4)]({'id_surface':_0x59fc48[_0x10ec5e][_0x33cc7a(0x1a4)]['toString']()})[_0x33cc7a(0x1b1)](),_0x4a56c1={'type':_0x33cc7a(0x19c),'properties':_0x59fc48[_0x10ec5e],'geometry':{'type':_0x12def4[_0x33cc7a(0x1ad)]>0x1?'MultiLineString':_0x33cc7a(0x1ab),'coordinates':[]}};for(let _0x1a47bc of _0x12def4){let _0x4bcab7=await(await _0x14b3dd[_0x33cc7a(0x1a0)]('NODE')['find']({'id_face':_0x1a47bc[_0x33cc7a(0x1a4)][_0x33cc7a(0x1aa)]()})[_0x33cc7a(0x1ac)]([_0x33cc7a(0x1b2)],0x1)[_0x33cc7a(0x1b1)]())[_0x33cc7a(0x1a3)](_0x2612ad=>{return[_0x2612ad['x'],_0x2612ad['y'],_0x2612ad['z']];});_0x4a56c1[_0x33cc7a(0x18d)]['coordinates'][_0x33cc7a(0x1b3)](_0x4bcab7);}_0x32c86a[_0x33cc7a(0x196)][_0x33cc7a(0x1b3)](_0x4a56c1);}_0x1077a8(_0x32c86a);}catch(_0x2e8826){_0x1077a8({'error':_0x2e8826});throw _0x2e8826;}});},module[_0xcf247e(0x1a5)][_0xcf247e(0x197)]=function(_0x510762,_0x3619d3){return new Promise(async(_0x5dc5e7,_0x176108)=>{const _0xc59a1a=_0x50cb;try{await db[_0xc59a1a(0x1a8)][_0xc59a1a(0x19e)]();const _0x73e5bf=await db[_0xc59a1a(0x1a8)]['db'](_0xc59a1a(0x1a2)),_0x4ef3c1=await _0x73e5bf['collection'](_0xc59a1a(0x195))[_0xc59a1a(0x19d)](_0x510762);for(let _0x4a56e7 in _0x3619d3){let _0x590ff2=await _0x73e5bf[_0xc59a1a(0x1a0)](_0xc59a1a(0x194))[_0xc59a1a(0x19d)]({'id_surface':_0x4ef3c1[_0xc59a1a(0x1a9)][_0xc59a1a(0x1aa)]()}),_0x1f783b=_0x3619d3[_0x4a56e7]['map']((_0x394077,_0x22d4d3)=>{const _0x42a221=_0xc59a1a;return{'x':_0x394077[0x0],'y':_0x394077[0x1],'z':_0x394077[0x2],'index':_0x22d4d3,'id_face':_0x590ff2[_0x42a221(0x1a9)]['toString']()};});await _0x73e5bf[_0xc59a1a(0x1a0)](_0xc59a1a(0x18e))['insertMany'](_0x1f783b);}_0x5dc5e7({'id_surface':_0x4ef3c1[_0xc59a1a(0x1a9)]});}catch(_0x446221){_0x5dc5e7(_0x446221);}});},module['exports'][_0xcf247e(0x1a1)]=function(_0x331105){return new Promise(async(_0x4a0aec,_0x4f9813)=>{const _0x1cc119=_0x50cb;try{await db[_0x1cc119(0x1a8)][_0x1cc119(0x19e)]();const _0x593810=await db[_0x1cc119(0x1a8)]['db']('block_b');await _0x593810[_0x1cc119(0x1a0)](_0x1cc119(0x195))['deleteOne']({'_id':_0x331105});const _0x54c6a5=await _0x593810[_0x1cc119(0x1a0)]('FACE')['find']({'id_surface':_0x331105[_0x1cc119(0x1aa)]()})[_0x1cc119(0x1b1)]();for(let _0x3ca30d of _0x54c6a5){await _0x593810['collection']('NODE')[_0x1cc119(0x1a7)]({'id_face':_0x3ca30d[_0x1cc119(0x1a4)][_0x1cc119(0x1aa)]()}),await _0x593810['collection']('FACE')['deleteOne']({'_id':_0x3ca30d[_0x1cc119(0x1a4)]});}_0x4a0aec(_0x1cc119(0x19f));}catch(_0x176210){_0x4f9813(_0x176210);}});};